# AI Art Station æ•°æ®åº“é…ç½®æ–‡ä»¶

## ğŸ“ æ–‡ä»¶ç»“æ„è¯´æ˜

è¿™ä¸ªæ–‡ä»¶å¤¹åŒ…å« AI Art Station é¡¹ç›®çš„æ‰€æœ‰ Supabase æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œå·²æŒ‰åŠŸèƒ½æ¨¡å—åŒ–é‡æ–°æ•´ç†ï¼š

### ğŸ“‹ æ‰§è¡Œé¡ºåº (æ¨è)

1. **ğŸš€ ä¸€é”®å®Œæ•´è®¾ç½® (æ¨è)**
   - `00-complete-setup.sql` - **å®Œæ•´è®¾ç½®è„šæœ¬ï¼ŒåŒ…å«æ‰€æœ‰åŠŸèƒ½**

2. **ğŸ“¦ åˆ†æ­¥éª¤è®¾ç½® (å¯é€‰)**
   - `01-tables.sql` - åŸºç¡€è¡¨ç»“æ„ + ç´¢å¼•
   - `02-policies.sql` - è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)
   - `03-functions.sql` - å‡½æ•°å’Œè§¦å‘å™¨
   - `04-storage.sql` - å­˜å‚¨æ¡¶å’Œæ–‡ä»¶ç­–ç•¥

---

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šä¸€é”®è®¾ç½® (æ¨è) â­

```sql
-- åœ¨ Supabase SQL ç¼–è¾‘å™¨ä¸­è¿è¡Œ
-- åŒ…å«å®Œæ•´çš„æ•°æ®åº“è®¾ç½® + éªŒè¯
\i 00-complete-setup.sql
```

### æ–¹æ³•äºŒï¼šåˆ†æ­¥è®¾ç½®

```sql
-- æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹æ–‡ä»¶ï¼š
\i 01-tables.sql      -- åˆ›å»ºè¡¨ç»“æ„
\i 02-policies.sql    -- è®¾ç½®å®‰å…¨ç­–ç•¥
\i 03-functions.sql   -- åˆ›å»ºå‡½æ•°å’Œè§¦å‘å™¨
\i 04-storage.sql     -- é…ç½®æ–‡ä»¶å­˜å‚¨
```

---

## ğŸ“Š åŒ…å«çš„åŠŸèƒ½

### ğŸ—„ï¸ æ•°æ®è¡¨ (8ä¸ª)

| è¡¨å | ç”¨é€” | ä¸»è¦å­—æ®µ |
|------|------|----------|
| `profiles` | ç”¨æˆ·èµ„æ–™ | username, display_name, avatar_url, bio |
| `user_settings` | ç”¨æˆ·è®¾ç½® | é€šçŸ¥ã€éšç§ã€æ˜¾ç¤ºã€å†…å®¹è®¾ç½® |
| `artworks` | ä½œå“ä¿¡æ¯ | title, description, prompt, image_url, tags |
| `comments` | è¯„è®ºç³»ç»Ÿ | content, artwork_id, user_id, parent_id |
| `likes` | ä½œå“ç‚¹èµ | user_id, artwork_id |
| `comment_likes` | è¯„è®ºç‚¹èµ | user_id, comment_id |
| `bookmarks` | æ”¶è— (åŸå§‹) | user_id, artwork_id |
| `user_favorites` | æ”¶è— (ä»£ç ) | user_id, artwork_id |

### ğŸ”’ å®‰å…¨åŠŸèƒ½

- **è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)** - ä¿æŠ¤ç”¨æˆ·æ•°æ®
- **è®¿é—®æ§åˆ¶** - ç²¾ç¡®çš„æƒé™ç®¡ç†
- **æ•°æ®éªŒè¯** - ç¡®ä¿æ•°æ®å®Œæ•´æ€§

### âš¡ è‡ªåŠ¨åŒ–åŠŸèƒ½

- **è‡ªåŠ¨è®¡æ•°** - ç‚¹èµæ•°ã€è¯„è®ºæ•°è‡ªåŠ¨æ›´æ–°
- **æ—¶é—´æˆ³** - è‡ªåŠ¨æ›´æ–° `updated_at` å­—æ®µ
- **ç”¨æˆ·æ³¨å†Œ** - è‡ªåŠ¨åˆ›å»ºç”¨æˆ·èµ„æ–™

### ğŸ“ æ–‡ä»¶å­˜å‚¨

- **ä½œå“å­˜å‚¨æ¡¶** (`artworks`) - ä¸Šä¼ çš„ä½œå“å›¾ç‰‡
- **å¤´åƒå­˜å‚¨æ¡¶** (`avatars`) - ç”¨æˆ·å¤´åƒ
- **è®¿é—®ç­–ç•¥** - å…¬å¼€è¯»å–ã€ç§æœ‰å†™å…¥

### ğŸš€ æ€§èƒ½ä¼˜åŒ–

- **æ•°æ®åº“ç´¢å¼•** - ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- **GIN ç´¢å¼•** - æ”¯æŒæ ‡ç­¾æ•°ç»„æœç´¢
- **æ—¶é—´æ’åº** - æŒ‰åˆ›å»ºæ—¶é—´å¿«é€Ÿæ’åº

---

## ğŸ› ï¸ æ–‡ä»¶è¯´æ˜

### `00-complete-setup.sql` â­
**å®Œæ•´çš„ä¸€é”®è®¾ç½®è„šæœ¬**
- åŒ…å«æ‰€æœ‰è¡¨ã€ç­–ç•¥ã€å‡½æ•°ã€è§¦å‘å™¨
- å†…ç½®éªŒè¯å’Œé”™è¯¯æ£€æŸ¥
- æ¨èç”¨äºåˆæ¬¡è®¾ç½®å’Œé‡ç½®

### `01-tables.sql`
**åŸºç¡€è¡¨ç»“æ„**
- åˆ›å»º 8 ä¸ªä¸»è¦æ•°æ®è¡¨
- æ·»åŠ æ€§èƒ½ä¼˜åŒ–ç´¢å¼•
- ä¸åŒ…å«å®‰å…¨ç­–ç•¥

### `02-policies.sql`
**å®‰å…¨ç­–ç•¥é…ç½®**
- å¯ç”¨æ‰€æœ‰è¡¨çš„ RLS
- é…ç½®ç²¾ç¡®çš„è®¿é—®æƒé™
- ä¿æŠ¤ç”¨æˆ·æ•°æ®å®‰å…¨

### `03-functions.sql`
**å‡½æ•°å’Œè§¦å‘å™¨**
- è‡ªåŠ¨æ›´æ–°å­—æ®µåŠŸèƒ½
- è®¡æ•°ç»Ÿè®¡åŠŸèƒ½
- ç”¨æˆ·æ³¨å†Œè‡ªåŠ¨åŒ–

### `04-storage.sql`
**å­˜å‚¨æ¡¶é…ç½®**
- åˆ›å»ºæ–‡ä»¶å­˜å‚¨æ¡¶
- é…ç½®è®¿é—®ç­–ç•¥
- æ”¯æŒå›¾ç‰‡ä¸Šä¼ 

---

## âœ… éªŒè¯æ­¥éª¤

### 1. æ£€æŸ¥è¡¨åˆ›å»º
```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('profiles', 'user_settings', 'artworks', 'comments', 'likes', 'comment_likes', 'bookmarks', 'user_favorites');
```

### 2. æ£€æŸ¥å­˜å‚¨æ¡¶
```sql
SELECT name, public 
FROM storage.buckets 
WHERE name IN ('artworks', 'avatars');
```

### 3. æ£€æŸ¥ç­–ç•¥
```sql
SELECT schemaname, tablename, policyname 
FROM pg_policies 
WHERE schemaname = 'public';
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ”¶è—åŠŸèƒ½æŠ¥é”™**
   - åŸå› ï¼šç¼ºå°‘ `user_favorites` è¡¨
   - è§£å†³ï¼šè¿è¡Œ `00-complete-setup.sql`

2. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - åŸå› ï¼šå­˜å‚¨æ¡¶æœªåˆ›å»ºæˆ–ç­–ç•¥é…ç½®é”™è¯¯
   - è§£å†³ï¼šæ£€æŸ¥ `04-storage.sql` æ˜¯å¦æ‰§è¡ŒæˆåŠŸ

3. **ç”¨æˆ·è®¾ç½®æ— æ³•ä¿å­˜**
   - åŸå› ï¼šç¼ºå°‘ `user_settings` è¡¨
   - è§£å†³ï¼šç¡®è®¤ `01-tables.sql` å·²æ‰§è¡Œ

### é‡ç½®æ•°æ®åº“

å¦‚éœ€å®Œå…¨é‡ç½®ï¼š
```sql
-- åˆ é™¤æ‰€æœ‰è¡¨ (è°¨æ…æ“ä½œ!)
DROP TABLE IF EXISTS user_favorites, bookmarks, comment_likes, likes, comments, artworks, user_settings, profiles CASCADE;

-- åˆ é™¤å­˜å‚¨æ¡¶
DELETE FROM storage.buckets WHERE name IN ('artworks', 'avatars');

-- é‡æ–°è¿è¡Œå®Œæ•´è®¾ç½®
\i 00-complete-setup.sql
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

- **v2.0** - é‡æ–°æ¨¡å—åŒ–è®¾è®¡ï¼ŒåŠŸèƒ½æ˜ç¡®åˆ†å·¥ï¼Œæ— é‡å¤å†…å®¹
- **v1.0** - åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«æ‰€æœ‰åŸºç¡€åŠŸèƒ½

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡è®¾ç½®**ï¼šç›´æ¥ä½¿ç”¨ `00-complete-setup.sql`
2. **é—®é¢˜ä¿®å¤**ï¼šæ ¹æ®å…·ä½“é—®é¢˜é€‰æ‹©å¯¹åº”çš„æ¨¡å—æ–‡ä»¶
3. **åŠŸèƒ½æ‰©å±•**ï¼šåœ¨å¯¹åº”çš„æ¨¡å—æ–‡ä»¶ä¸­æ·»åŠ æ–°åŠŸèƒ½
4. **å¤‡ä»½è¿˜åŸ**ï¼šå®šæœŸå¤‡ä»½æ•°æ®åº“ç»“æ„å’Œæ•°æ®

âš ï¸ **æ³¨æ„**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ‰§è¡Œä»»ä½• SQL è„šæœ¬å‰ï¼Œè¯·åŠ¡å¿…å…ˆå¤‡ä»½æ•°æ®åº“ï¼ 